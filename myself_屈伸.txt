#pragma strict

static var my_speed				= 1;
static var my_updown_mergin		= 0.05;
//static var gravity_accel		= -9.80665; /* FIXME: 動作テスト用の仮値なので宇宙空間やエミュでは動かない。値を初期化する処理が必要。 */
static var gravity_accel		= Input.acceleration.y;	// TODO: この表記はいまいち正確ではない。数秒間計測し、その平均にするべきだ。
static var my_updown_time		= 0;

function Update ()
{
	// 加速度センサ
	var my_accel_y = Input.acceleration.y - gravity_accel;
	
	if (my_updown_time > 0)	// しゃがんでる
	{
		--my_updown_time;
		if (my_updown_time == 0)
		{
			transform.localPosition = Vector3(transform.localPosition.x, transform.localPosition.y + 2, transform.localPosition.z);
		}
	}
	else					// 立ってる
	{
		if (my_accel_y < -my_updown_mergin)	// しゃがもうとしている
		{
			// しゃがむ
			my_updown_time = 60;
			transform.localPosition = Vector3(transform.localPosition.x, transform.localPosition.y - 2, transform.localPosition.z);
		}
	}
	
	// TODO: ゲームクリア判定。
	//		 プレイヤーが特定の距離まで進んだらクリアとする。
	//		 シーン遷移でゲームクリア画面へ飛ばす。
}

function OnTriggerEnter (collider : Collider)	//	当たった
{
	// TODO: 体力ゲージの減少
	// TODO: ifでゲームオーバーに遷移 ( こちらは別ソースに移るかもしれない )
	
	// 当たり判定の削除
	collider.isTrigger = false;
}
